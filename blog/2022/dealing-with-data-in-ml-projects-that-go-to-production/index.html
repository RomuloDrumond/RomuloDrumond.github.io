<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Dealing with data in ML projects that go to Production | Romulo Drumond</title> <meta name="author" content="Romulo B. P. Drumond"/> <meta name="description" content="Analysis of problems and tools at our disposal"/> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img/favicon-32x32.png"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://romulodrumond.com/blog/2022/dealing-with-data-in-ml-projects-that-go-to-production/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Romulo Drumond</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Dealing with data in ML projects that go to Production</h1> <p class="post-meta">December 5, 2022</p> <p class="post-tags"> <a href="/blog/2022"> <i class="fas fa-calendar fa-sm"></i> 2022 </a>   ·   <a href="/blog/tag/mlops"> <i class="fas fa-hashtag fa-sm"></i> MLOps</a>   <a href="/blog/tag/spark"> <i class="fas fa-hashtag fa-sm"></i> Spark</a>   </p> </header> <article class="post-content"> <ul> <li><a href="#1-introduction">1. Introduction</a></li> <li><a href="#2-do-you-need-data-version-control">2. Do you need data version control?</a></li> <li> <a href="#3-tools-for-dealing-with-data-in-ml-projects">3. Tools for dealing with data in ML projects</a> <ul> <li><a href="#31-git-git-lfs">3.1 Git, Git-LFS</a></li> <li><a href="#32-data-version-control-dvc">3.2 Data Version Control (DVC)</a></li> <li><a href="#33-delta-tables-databricks">3.3 Delta Tables (Databricks)</a></li> <li><a href="#34-honorable-mentions">3.4 Honorable mentions</a></li> </ul> </li> <li><a href="#4-conclusion">4. Conclusion</a></li> </ul> <h1 id="1-introduction">1. Introduction</h1> <p>“Data” in a Machine Learning (ML) project can mean many things:</p> <ul> <li>The train/validation/test data needed to train/validate/test a machine learning model;</li> <li>A special/proprietary tokenizer for Natural Language Processing (NLP) projects;</li> <li>A not-so-small map between entities/variables;</li> <li>An “auxiliary” model, usually static, as the ones used for generating embeds, object detection, etc;</li> <li>and more…</li> </ul> <p>In this blog post “data” will have this loose definition: any file/artifact that usually is not produced by the developer, having a very wide range of sizes (from KB in case of small data sets to GB in case of big NLP models).</p> <p>With that in mind, a Data Scientist (DS) or Machine Learning Engineer (MLE) should have a solution to store, version, and deploy the data. In an enterprise setting these concerns becomes the questions:</p> <ol> <li>Where is the data stored? How can we configure the access control?</li> <li>Can we have version control? Do we even need that?</li> <li>Deployment to Production and syncs with the Development environment. Do we need environments synced?</li> </ol> <p style="margin-bottom:0;"> <details><summary>(click to expand) <strong>Suggestion when starting</strong></summary> When working on an ML project beyond a Proof of Concept (POC), consider building a list of all data dependencies (not only the external ones). </details> </p> <h1 id="2-do-you-need-data-version-control">2. Do you need data version control?</h1> <p>From the questions raised in the introduction, you may be thinking: <em>Do I even need such a thing as version control on all my data?</em></p> <p>The not-so-surprising answer is: <strong>It depends.</strong></p> <p>What is the motivation for data version control then?</p> <ol> <li>Incident recovery and rollbacks;</li> <li>Model training and data pipelines reproducibility;</li> <li>Bonus: doing a historic data analysis going into the past.</li> </ol> <p>Ok ok, it seems like good capabilities to have, at least for the second point, a crucial one from the ML operations (MLOps) point of view. But having it for all data maybe be troublesome and add no real value. So, <strong>what are the cases in that version control is not necessary?</strong></p> <ul> <li>If the data doesn’t change frequently or doesn’t change at all;</li> <li>If new data is only appended, not deleted or updated;</li> <li>If the data changes frequently and the updates make more sense being modeled (e.g. receiving events from external sources that it is not reliable, it makes more sense to have all events in a table with their timestamp)</li> </ul> <h1 id="3-tools-for-dealing-with-data-in-ml-projects">3. Tools for dealing with data in ML projects</h1> <p>With the objective of answering the 3 starting questions, some of the following tools you may consider.</p> <h2 id="31-git-git-lfs">3.1 Git, Git-LFS</h2> <ol> <li> <strong>Where is the data stored?</strong> On the GIT remote servers, being external providers (e.g. <a href="https://github.com/" target="_blank" rel="noopener noreferrer">Github</a>, <a href="https://about.gitlab.com/" target="_blank" rel="noopener noreferrer">Gitlab</a>, <a href="https://gitbucket.github.io/" target="_blank" rel="noopener noreferrer">Gitbucket</a>, <a href="https://bitbucket.org/product" target="_blank" rel="noopener noreferrer">Bitbucket</a>…) or self-provided.</li> <li> <strong>Can we have version control?</strong> Very strong and familiar version control for developers.</li> <li> <strong>Deployment and sync between environments?</strong> Given most projects relies on container images, having the data with the code is the easiest way to deploy it between environments, just needs to deploy the container image.</li> </ol> <p>Other points to consider:</p> <ul> <li> <img class="emoji" title=":white_check_mark:" alt=":white_check_mark:" src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png" height="20" width="20"> Strong versioning and very difficult history deletion;</li> <li> <img class="emoji" title=":white_check_mark:" alt=":white_check_mark:" src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png" height="20" width="20"> Data format agnostic;</li> <li> <img class="emoji" title=":x:" alt=":x:" src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png" height="20" width="20"> Container image size: depending on the data size the Continous Delivery (CD) pipelines will slow down and might break due to disk space usage;</li> <li> <img class="emoji" title=":x:" alt=":x:" src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png" height="20" width="20"> Default data comparison: you will need to download both file versions and compare if the format is not human-readable. Examples of human-readable: CSV and JSON. Examples of not human-readable: binary and parquet;</li> <li> <img class="emoji" title=":x:" alt=":x:" src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png" height="20" width="20"> Max file size of 100 MB on default git and 10 GB on git-lfs.</li> </ul> <h2 id="32-data-version-control-dvc">3.2 Data Version Control (<a href="https://dvc.org/" target="_blank" rel="noopener noreferrer">DVC</a>)</h2> <ol> <li> <strong>Where is the data stored?</strong> It accepts many <a href="https://dvc.org/doc/command-reference/remote/add#supported-storage-types" target="_blank" rel="noopener noreferrer">backends</a> (this is pretty awesome by the way).</li> <li> <strong>Can we have version control?</strong> Yes, very git-like.</li> <li> <strong>Deployment and sync between environments?</strong> Just like git you may do a “<code class="language-plaintext highlighter-rouge">git pull</code>” with a flag.</li> </ol> <p>Other points to consider:</p> <ul> <li> <img class="emoji" title=":white_check_mark:" alt=":white_check_mark:" src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png" height="20" width="20"> Git-like interface;</li> <li> <img class="emoji" title=":white_check_mark:" alt=":white_check_mark:" src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png" height="20" width="20"> Data format agnostic;</li> <li> <img class="emoji" title=":white_check_mark:" alt=":white_check_mark:" src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png" height="20" width="20"> Ability to use multiple backends;</li> </ul> <p><em>Personal note: It is a great tool for migrating from the limitations of Git and Git-LFS, but not so good for big data environments.</em></p> <h2 id="33-delta-tables-databricks">3.3 Delta Tables (Databricks)</h2> <ol> <li> <strong>Where is the data stored?</strong> Multiple backends, usually some data lake (ADLS, S3, etc).</li> <li> <strong>Can we have version control?</strong> Yes, delta history.</li> <li> <strong>Deployment and sync between environments?</strong> Needs to be implemented.</li> </ol> <p>Other points to consider:</p> <ul> <li> <img class="emoji" title=":white_check_mark:" alt=":white_check_mark:" src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png" height="20" width="20"> Easy data comparison: For example, one can use in the same SQL query multiple table versions;</li> <li> <img class="emoji" title=":white_check_mark:" alt=":white_check_mark:" src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png" height="20" width="20"> Can configure retain policy and when to run VACUUM commands, so we can control the period of the data history, consequently, its size;</li> <li> <img class="emoji" title=":white_check_mark:" alt=":white_check_mark:" src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png" height="20" width="20"> <img class="emoji" title=":x:" alt=":x:" src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png" height="20" width="20"> Better suited to be used with Spark;</li> <li> <img class="emoji" title=":x:" alt=":x:" src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png" height="20" width="20"> Easy table deletion history;</li> <li> <img class="emoji" title=":x:" alt=":x:" src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png" height="20" width="20"> Fixed data format: tables.</li> </ul> <h2 id="34-honorable-mentions">3.4 Honorable mentions</h2> <p><strong><a href="https://www.mlflow.org/" target="_blank" rel="noopener noreferrer">MLflow</a></strong>: best option when thinking about versioning models;</p> <p><strong><a href="https://www.pachyderm.com/" target="_blank" rel="noopener noreferrer">Pachyderm</a></strong>: core feature is to run and version data-driven pipelines. Seems to want to do many things at once, too convoluted to be used to solve the starting three problem;</p> <p><strong><a href="https://lakefs.io/" target="_blank" rel="noopener noreferrer">LakeFS</a></strong>: versions the whole data lake, seems like a tool for a company’s data teams.</p> <p><strong><a href="https://www.dolthub.com/" target="_blank" rel="noopener noreferrer">Dolt</a></strong>: a SQL database that feels like a git repository. The problem is that it is a database in itself, too big of a solution.</p> <h1 id="4-conclusion">4. Conclusion</h1> <p>Given my experiences and analysis of this article, my rules of thumb are:</p> <ul> <li> <p>For data below 100 MB use GIT, for bigger than that, although you could use GIT-LFS, it slows down and may break CD pipelines. GIT is robust and time-proven, also, deploying data in environments is automatic as we usually build container images with all files of the code repository.</p> </li> <li> <p>For bigger data, give preference to Delta Tables as we can control table history range and consequently its size. As our team usually works with Spark, DVC does not show to be too much compelling when compared to Delta tables.</p> </li> </ul> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Romulo B. P. Drumond. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>